---
import "../styles/global.css";
import { getEntry } from "astro:content";
import { ClientRouter } from "astro:transitions";

interface Props {
	title?: string;
	description?: string;
}

const { title, description } = Astro.props;

const siteConfig = await getEntry("siteConfig", "site-config");
const site = siteConfig?.data!;

const pageTitle = title ? `${title} - ${site.siteName}` : site.siteTitle;
const pageDescription = description || site.siteDescription;
---

<!doctype html>
<html class="scroll-smooth" lang="en">
	<head>
		<meta charset="utf-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1, shrink-to-fit=no"
		/>
		<meta name="description" content={pageDescription} />
		<meta name="keywords" content={site.siteKeywords} />
		<title>{pageTitle}</title>
		<!-- Favicon -->
		<link href="/assets/images/favicon.png" rel="shortcut icon" />
		<!-- CSS -->
		<link
			href="/assets/plugins/swiper/swiper-bundle.min.css"
			rel="stylesheet"
		/>
		<link
			href="/assets/plugins/glightbox/glightbox.min.css"
			rel="stylesheet"
		/>
		<!-- Fonts/Icons -->
		<link
			href="/assets/plugins/bootstrap-icons/bootstrap-icons.css"
			rel="stylesheet"
		/>

		<ClientRouter />
	</head>

	<body class="bg-black font-opensans overflow-x-hidden">
		<!-- Header -->
		<div class="z-10 fixed top-0 left-0 w-full py-5">
			<div class="container mx-auto max-w-[1600px] px-5 md:px-10">
				<div class="flex justify-between relative">
					<a href="/" class="text-3xl font-outfit font-medium text-white">
						{site.siteName}
					</a>
					<div>
						<ul class="space-x-2">
							<li class="list-none inline-block">
								<a
									class="inline-block relative z-[1] overflow-hidden group px-5 py-2.5 pr-[34px] backdrop-blur bg-white/15 text-white font-outfit rounded-3xl uppercase text-sm font-medium tracking-wider before:content-[''] before:absolute before:-z-[1] before:left-0 before:top-0 before:w-full before:h-full before:bg-themeGradient before:opacity-0 hover:before:opacity-20 before:transition-all before:ease-linear before:duration-100 after:content-[''] after:absolute after:top-1/2 after:right-[20px] after:-translate-y-1/2 after:bg-white after:w-[5px] after:h-[5px] after:rounded-full after:transition-all after:duration-[60ms] hover:after:opacity-40 hover:after:scale-[2.7]"
									href="#contact"
								>
									<span
										class="block relative text-transparent before:content-[attr(data-text)] before:absolute before:top-0 before:left-0 before:opacity-100 before:text-white before:transition-all before:ease-out before:duration-200 group-hover:before:-top-full group-hover:before:opacity-0 after:content-[attr(data-text)] after:absolute after:top-full after:left-0 after:opacity-0 after:text-white after:transition-all after:ease-out after:duration-200 group-hover:after:top-0 group-hover:after:opacity-100"
										data-text="Let's Talk">Let's Talk</span
									>
								</a>
							</li>
							<li class="list-none inline-block">
								<div
									id="nav-toggle"
									class="inline-block relative z-[1] overflow-hidden cursor-pointer group px-5 py-2.5 pr-[34px] bg-white text-black font-outfit rounded-3xl uppercase text-sm font-medium tracking-wider after:content-[''] after:absolute after:top-1/2 after:right-[20px] after:-translate-y-1/2 after:bg-black after:w-[5px] after:h-[5px] after:rounded-full after:transition-all after:duration-[60ms] hover:after:opacity-40 hover:after:scale-[2.7] cursor-link"
								>
									<span
										class="block relative text-transparent before:content-[attr(data-text)] before:absolute before:top-0 before:left-0 before:opacity-100 before:text-black before:transition-all before:ease-out before:duration-200 group-hover:before:-top-full group-hover:before:opacity-0 after:content-[attr(data-text)] after:absolute after:top-full after:left-0 after:opacity-0 after:text-black after:transition-all after:ease-out after:duration-200 group-hover:after:top-0 group-hover:after:opacity-100"
										data-text="Menu">Menu</span
									>
								</div>
							</li>
						</ul>
					</div>
					<!-- Toggle Menu -->
					<nav
						class="nav-box absolute overflow-hidden invisible opacity-0 translate-y-[5px] top-[60px] right-0 bg-white/10 px-7 py-6 min-w-[250px] rounded-lg font-outfit text-xl backdrop-blur transition-all ease-linear duration-100 before:content-[''] before:absolute before:-z-[1] before:left-0 before:top-0 before:w-full before:h-full before:bg-themeGradient before:opacity-30"
					>
						<ul class="space-y-[10px]">
							<li class="list-none">
								<a
									class="text-white block relative hover:pl-[26px] transition-all ease-out duration-300 group"
									href="#about"
									><i
										class="bi bi-arrow-right absolute top-1/2 left-0 -translate-y-1/2 opacity-0 invisible transition-all ease-linear duration-100 group-hover:opacity-100 group-hover:visible"
									></i>About</a
								>
							</li>
							<li class="list-none">
								<a
									class="text-white block relative hover:pl-[26px] transition-all ease-out duration-300 group"
									href="#services"
									><i
										class="bi bi-arrow-right absolute top-1/2 left-0 -translate-y-1/2 opacity-0 invisible transition-all ease-linear duration-100 group-hover:opacity-100 group-hover:visible"
									></i>Services</a
								>
							</li>
							<li class="list-none">
								<a
									class="text-white block relative hover:pl-[26px] transition-all ease-out duration-300 group"
									href="#portfolio"
									><i
										class="bi bi-arrow-right absolute top-1/2 left-0 -translate-y-1/2 opacity-0 invisible transition-all ease-linear duration-100 group-hover:opacity-100 group-hover:visible"
									></i>Portfolio</a
								>
							</li>
							<li class="list-none">
								<a
									class="text-white block relative hover:pl-[26px] transition-all ease-out duration-300 group"
									href="#awards"
									><i
										class="bi bi-arrow-right absolute top-1/2 left-0 -translate-y-1/2 opacity-0 invisible transition-all ease-linear duration-100 group-hover:opacity-100 group-hover:visible"
									></i>Awards</a
								>
							</li>
							<li class="list-none">
								<a
									class="text-white block relative hover:pl-[26px] transition-all ease-out duration-300 group"
									href="#testimonial"
									><i
										class="bi bi-arrow-right absolute top-1/2 left-0 -translate-y-1/2 opacity-0 invisible transition-all ease-linear duration-100 group-hover:opacity-100 group-hover:visible"
									></i>Testimonial</a
								>
							</li>
							<li class="list-none">
								<a
									class="text-white block relative hover:pl-[26px] transition-all ease-out duration-300 group"
									href="#blog"
									><i
										class="bi bi-arrow-right absolute top-1/2 left-0 -translate-y-1/2 opacity-0 invisible transition-all ease-linear duration-100 group-hover:opacity-100 group-hover:visible"
									></i>Blog</a
								>
							</li>
							<li class="list-none">
								<a
									class="text-white block relative hover:pl-[26px] transition-all ease-out duration-300 group"
									href="#contact"
									><i
										class="bi bi-arrow-right absolute top-1/2 left-0 -translate-y-1/2 opacity-0 invisible transition-all ease-linear duration-100 group-hover:opacity-100 group-hover:visible"
									></i>Contact</a
								>
							</li>
						</ul>
					</nav>
				</div>
			</div>
		</div>
		<!-- end Header -->
		<slot />
		<!-- Footer -->
		<div class="container text-center px-5 py-9 xl:py-10">
			<p class="text-white/70" set:html={site.footerText}>
			</p>
		</div>
		<!-- end Footer -->

		<!-- Scroll to Top -->
		<div
			class="scrolltotop fixed right-5 bottom-5 xl:right-10 invisible opacity-0 translate-y-5 backdrop-blur transition-all ease-out duration-[120ms] cursor-pointer inline-block group w-[50px] h-[50px] rounded-full bg-white/15 text-white z-[1] overflow-hidden before:content-[''] before:absolute before:-z-[1] before:left-0 before:top-0 before:w-full before:h-full before:bg-themeGradient before:opacity-0 hover:before:opacity-20 before:transition-all before:ease-linear before:duration-100 cursor-link"
		>
			<i
				class="bi bi-arrow-up absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 transition-all ease-out duration-200 group-hover:top-0 group-hover:invisible group-hover:opacity-0"
			></i>
			<i
				class="bi bi-arrow-up absolute top-full left-1/2 -translate-x-1/2 -translate-y-1/2 transition-all ease-out duration-200 invisible opacity-0 group-hover:top-1/2 group-hover:visible group-hover:opacity-100"
			></i>
		</div>
		<!-- end Scroll to Top -->

		<!-- Cursor -->
		<!-- <div
			id="cursor"
			class="hidden lg:inline-block z-[11] absolute -translate-x-1/2 -translate-y-1/2 bg-white w-[10px] h-[10px] rounded-full mix-blend-difference pointer-events-none transition-all ease-linear duration-[80ms]"
		>
		</div> -->
		<!-- end Cursor -->
		<!-- JavaScripts -->
		<script src="/assets/plugins/plugins.js" defer></script>
		<script src="/assets/spa-init.js" defer></script>
		
		<!-- Arabic Font Support Script -->
		<script>
		document.addEventListener('DOMContentLoaded', function() {
			// Function to detect Arabic text
			function containsArabic(text) {
				const arabicPattern = /[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;
				return arabicPattern.test(text);
			}
			
			// Function to check if text is predominantly Arabic
			function isPredominantlyArabic(text) {
				const arabicChars = (text.match(/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/g) || []).length;
				const totalChars = text.replace(/\s/g, '').length; // Remove spaces for counting
				return totalChars > 0 && (arabicChars / totalChars) > 0.3; // More than 30% Arabic
			}
			
			// Function to apply Arabic styling to elements
			function applyArabicStyling(element) {
				element.style.fontFamily = "'Cairo', 'Noto Sans Arabic', 'Segoe UI', Tahoma, Arial, sans-serif";
				element.style.direction = "rtl";
				element.style.textAlign = "right";
				element.style.lineHeight = "1.8";
				element.style.fontWeight = "400";
				element.style.letterSpacing = "0";
			}
			
			// Function to apply mixed content styling (Arabic font but LTR direction)
			function applyMixedStyling(element) {
				element.style.fontFamily = "'Cairo', 'Noto Sans Arabic', 'Open Sans', 'Segoe UI', Tahoma, Arial, sans-serif";
				// Keep original direction and alignment for mixed content
			}
			
			// Check all text elements for Arabic content
			function checkAndStyleArabicText() {
				const textElements = document.querySelectorAll('p, div, span, h1, h2, h3, h4, h5, h6, li');
				
				textElements.forEach(function(element) {
					// Skip if already processed or if it's a container with multiple children
					if (element.classList.contains('arabic-processed') || element.children.length > 0) {
						return;
					}
					
					const textContent = element.textContent || element.innerText;
					if (textContent && textContent.trim()) {
						if (isPredominantlyArabic(textContent)) {
							// Predominantly Arabic - apply full RTL styling
							applyArabicStyling(element);
							element.classList.add('arabic-text', 'arabic-processed');
						} else if (containsArabic(textContent)) {
							// Contains some Arabic - apply Arabic font but keep LTR
							applyMixedStyling(element);
							element.classList.add('mixed-text', 'arabic-processed');
						} else {
							// English only - mark as processed to avoid re-checking
							element.classList.add('arabic-processed');
						}
					}
				});
			}
			
			// Run the check
			checkAndStyleArabicText();
			
			// Also run after any dynamic content changes
			const observer = new MutationObserver(function(mutations) {
				mutations.forEach(function(mutation) {
					if (mutation.type === 'childList') {
						// Wait a bit for content to settle
						setTimeout(checkAndStyleArabicText, 100);
					}
				});
			});
			
			observer.observe(document.body, {
				childList: true,
				subtree: true
			});
		});
		</script>
	</body>
</html>
